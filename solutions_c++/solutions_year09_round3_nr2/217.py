// B.cpp : 定义控制台应用程序的入口点。
//

#include "stdafx.h"


#include"iostream"
#include"math.h"
using namespace std;
int main()
{
	freopen("G:\\B-large.in","r",stdin);
	freopen("G:\\bout.out","w",stdout);
	int n,t,i,ci=1;
	double a1,a2,a3,b1,b2,b3,x,y,z,vx,vy,vz,anst,a,b,c,k,out;
	scanf("%d",&t);
	while(t--){
		scanf("%d",&n);
		//if(ci == 12)
		//	printf("%d\n",n);
		a1 = a2 = a3 = b1 = b2 = b3 = 0;
		for(i=0;i<n;i++){
			scanf("%lf%lf%lf%lf%lf%lf",&x,&y,&z,&vx,&vy,&vz);
			//if(ci == 12)
			//	printf("%lf %lf %lf %lf %lf %lf\n",x,y,z,vx,vy,vz);
			//k = 1/sqrt(vx*vx+vy*vy+vz*vz);
			a1 += x;	b1 += vx;
			a2 += y;	b2 += vy;
			a3 += z;	b3 += vz;
		}
		a = b1*b1 + b2*b2 + b3*b3;
		c= (a1*a1+a2*a2+a3*a3);
		b = 2*(a1*b1+a2*b2+a3*b3);
		
		if(a == 0){
			if(b < 0){
				printf("Case #%d: %.8lf %.8lf\n",ci++,0.0,c / (-1.0*b) );
				continue;
			}
			else /*if(a1*b1=a2*b2+a3*b3 >= 0)*/{
				if(c == 0){
					printf("Case #%d: %.8lf %.8lf\n",ci++,0.0,0.0);
				}
				else
				printf("Case #%d: %.8lf %.8lf\n",ci++,sqrt(c/(n*n)),0.0);
				continue;
			}
		} 
		else{
			if(b*b-4*a*c < 0){
				anst = -1.0*b/(2*a);
				if(anst < 0)
					anst = 0;
			}
			else{
				//int tt = sqrt(b*b-4*a*c);
				anst = (-b-sqrt(b*b-4*a*c))/(2*a);
				if(anst<0)
					anst = (-b+sqrt(b*b-4*a*c))/(2*a);
				if(anst<0)
					anst = 0;
			}
			if((a*anst*anst+b*anst+c)/(n*n) < 0.000000001)
				out = 0;
			else
				out = sqrt((a*anst*anst+b*anst+c)/(n*n));
			if(anst < 0.0 && anst > -0.000000001)
				anst = 0.0;
			if(anst == 0.0)
				anst = 0.0;
			printf("Case #%d: %.8lf %.8lf\n",ci++,out,anst);
		}
	}
	return 0;
}
/*
1
3
-2399.000000 -3107.000000 2495.000000 -1289.000000 -4913.000000 4063.000000
4631.000000 93.000000 -665.000000 4558.000000 1379.000000 -2251.000000
-3992.000000 2277.000000 -444.000000 -869.000000 4539.000000 -3702.000000
5
5
1.000000 4.000000 5.000000 6.000000 3.000000 -4.000000
0.000000 5.000000 5.000000 -6.000000 2.000000 -5.000000
-3.000000 -6.000000 -3.000000 -4.000000 -5.000000 1.000000
-2.000000 4.000000 -4.000000 0.000000 2.000000 -2.000000
0.000000 -6.000000 -3.000000 1.000000 -2.000000 4.000000

1
10
-4331.000000 -4287.000000 -1808.000000 490.000000 -1154.000000 -1066.000000
3194.000000 1441.000000 717.000000 1564.000000 -2593.000000 -3546.000000
1888.000000 2769.000000 4498.000000 658.000000 3901.000000 -509.000000
-925.000000 -768.000000 -4495.000000 1.000000 18.000000 3526.000000
3580.000000 -316.000000 3277.000000 1558.000000 3286.000000 3747.000000
-1232.000000 1549.000000 -2066.000000 1722.000000 4775.000000 2838.000000
2507.000000 288.000000 -610.000000 -2272.000000 -4573.000000 1426.000000
101.000000 654.000000 797.000000 -2218.000000 -992.000000 -1703.000000
-4737.000000 -1873.000000 -1816.000000 -2291.000000 -340.000000 -4159.000000
-45.000000 543.000000 1506.000000 -2074.000000 -3162.000000 4993.000000
*/
