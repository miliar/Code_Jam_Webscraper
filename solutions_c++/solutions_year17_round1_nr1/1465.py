#include <bits/stdc++.h>
using namespace std;
int t,i,j,k,r,c,l;
char ch[30][30];
int main()
{
	cin>>t;
	for(i=1;i<=t;i++)
	{
		cin>>r>>c;
		for(j=0;j<r;j++)
		{
			for(k=0;k<c;k++)
			{
				cin>>ch[j][k];
			}
		}
		for(k=0;k<c;k++)
		{
			for(j=0;j<r;j++)
			{
				if(ch[j][k]!='?')
				{
					l=j+1;
					while(l<r&&ch[l][k]=='?')
					{
						if(ch[l][k]=='?')
						{
							ch[l][k]=ch[j][k];
						}
						else
						break;
						l++;
					}
					l=j-1;
					while(l>=0&&ch[l][k]=='?')
					{
						if(ch[l][k]=='?')
						{
							ch[l][k]=ch[j][k];
						}
						else
						break;
						l--;
					}
				}
			}
		}
		for(j=0;j<r;j++)
		{
			for(k=0;k<c;k++)
			{
				if(ch[j][k]!='?')
				{
					 l=k+1;
					while(l<c&&ch[j][l]=='?')
					{
						if(ch[j][l]=='?')
						{
							ch[j][l]=ch[j][k];
						}
						else
						break;
						l++;
					}
					l=k-1;
					while(l>=0&&ch[j][l]=='?')
					{
						if(ch[j][l]=='?')
						{
							ch[j][l]=ch[j][k];
						}
						else
						break;
						l--;
					}
				}
			}
		}
		cout<<"Case #"<<i<<":\n";
		for(j=0;j<r;j++)
		{
			for(k=0;k<c;k++)
			{
				cout<<ch[j][k];
			}
			cout<<"\n";
		}
	}
    return 0;
}

