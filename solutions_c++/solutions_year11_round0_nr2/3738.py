#include<STDLIB.H><νεθ#include<iostream><νεθ#include<stdio.h><νεθ#include<vector><νεθ#include<string><νεθ#include<cmath><νεθ#include<time.h><νεθ#include<set><νεθ#include<algorithm><νεθ#include<fstream><νεθusing namespace std;<νεθ<νεθvector <char> mas;<νεθtypedef vector<char>::iterator it;<νεθ<νεθint main(){<νεθofstream file("D:\\1.txt");<νεθint t;<νεθcin >> t;<νεθfor (int test=0; test<t; test++){<νεθ	int c,w; <νεθ	char comb[1000][3];<νεθ	char wrong [1000][2];<νεθ	string a;<νεθ	cin >> c;<νεθ	for (int i=0; i<c; i++){<νεθ		cin >> a;<νεθ		comb[i][0]=a[0];<νεθ		comb[i][1]=a[1];<νεθ		comb[i][2]=a[2];<νεθ	}<νεθ	cin >>w;<νεθ	for (int i=0; i<w; i++){<νεθ		cin >> a;<νεθ		wrong[i][0]=a[0];<νεθ		wrong[i][1]=a[1];<νεθ	}<νεθ	int n;<νεθ	char h;<νεθ	cin >> n;<νεθ	for (int i=0; i<n; i++){<νεθ		bool not=false;<νεθ		cin >> h;<νεθ		if (mas.empty()) mas.push_back(h); <νεθ		else{<νεθ			for (int j=0; j<c; j++){<νεθ				if (not==true) break;<νεθ				if (mas.back()==comb[j][0])<νεθ					if (h==comb[j][1]){<νεθ						mas.pop_back();<νεθ						mas.push_back(comb[j][2]);<νεθ						not=true;<νεθ					}<νεθ				if (not==true)break;<νεθ				if (mas.back()==comb[j][1])<νεθ					if (h==comb[j][0]){<νεθ							mas.pop_back();<νεθ							mas.push_back(comb[j][2]);<νεθ							not=true;<νεθ					}<νεθ			}<νεθ			if (not==false) mas.push_back(h);<νεθ			for (int j=0; j<w; j++){<νεθ				if (mas.back()==wrong[j][0])<νεθ					for (int k=0; k<mas.size(); k++){<νεθ						if (mas[k]==wrong[j][1]&&k!=mas.size()-1){<νεθ							mas.clear();<νεθ						}<νεθ					}<νεθ				if (mas.empty()) break; <νεθ				if (mas.back()==wrong[j][1])<νεθ					for (int k=0; k<mas.size(); k++){<νεθ						if (mas[k]==wrong[j][0]&&k!=mas.size()-1){<νεθ							mas.clear();<νεθ						}<νεθ					}<νεθ			}<νεθ<νεθ		}<νεθ	}<νεθ	file << "Case #" << test+1 << ": ";<νεθ	file << "[";<νεθ	for (int i=0; i<mas.size(); i++){<νεθ		file << mas[i];<νεθ		if (i!=mas.size()-1) file  << ", ";<νεθ	}<νεθ	file << "]" << endl;<νεθ	mas.clear();<νεθ}<νεθfile.close();<νεθreturn 0;<νεθ}<νεθ<νεθ