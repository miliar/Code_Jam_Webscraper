#include<iostream>
using namespace std;

int main()
{
    int N;
    cin >> N;
    for (int j=0;j<N;j++)
    {
        long long int n,a,b,c,d,x0,y0,M;
        long long int x,y,ans;
        cin>>n>>a>>b>>c>>d>>x0>>y0>>M;
        int a11=0,a12=0,a10=0,a21=0,a22=0,a20=0,a01=0,a02=0,a00=0;
        x=x0;y=y0;
        for(int i=0;i<n;i++)
        {
                if(((x%3)==0)&&((y%3)==0)){a00++;}
                if(((x%3)==0)&&((y%3)==1)){a01++;}
                if(((x%3)==0)&&((y%3)==2)){a02++;}
                if(((x%3)==1)&&((y%3)==0)){a10++;}
                if(((x%3)==1)&&((y%3)==1)){a11++;}
                if(((x%3)==1)&&((y%3)==2)){a12++;}
                if(((x%3)==2)&&((y%3)==0)){a20++;}
                if(((x%3)==2)&&((y%3)==1)){a21++;}
                if(((x%3)==2)&&((y%3)==2)){a22++;}
                x = (x*a+b)%M;
                y = (y*c+d)%M;
        }
        //1| 2: 3 4 5 6 7 8 9 10 111 12 13 14 15 16
        ans = (a00*(a00-1)*(a00-2) + a01*(a01-1)*(a01-2) + a02*(a02-1)*(a02-2) 
        + a10*(a10-1)*(a10-2) + a11*(a11-1)*(a11-2) + a12*(a12-1)*(a12-2) 
        + a20*(a20-1)*(a20-2) + a21*(a21-1)*(a21-2) + a22*(a22-1)*(a22-2))/6
        + a00*a01*a02 + a10*a11*a12 + a20*a21*a22
        + a00*a10*a20 + a01*a11*a21 + a02*a12*a22
        + a11*a22*a00 + a12*a21*a00 + a11*a20*a02 + a10*a22*a01 + a12*a20*a01 + a10*a21*a02;
        
        cout<<"Case #"<<j+1<<": "<<ans<<endl;
    }     
}
