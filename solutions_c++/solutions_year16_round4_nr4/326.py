#include <stdio.h>
#include <ctype.h>
#include <string.h>
#include <stdlib.h>
#include <limits.h>
#include <math.h>
#include <algorithm>
#include <bitset>
using namespace std;
typedef long long ll;

int table[5][1100]={
{0},
{1},
{6,9,15},
{84,98,118,140,161,173,220,227,266,273,283,341,362,398,433,511},
{4680,4740,4812,5160,5250,5290,5736,5766,6180,6210,6246,6730,6820,7212,7362,7918,8520,8580,8652,9240,9345,9369,9560,9605,10260,10305,10325,10569,10644,11292,11457,11741,13128,13188,13260,13368,13443,14388,14403,15420,15555,16680,16770,16810,16920,17025,17049,17208,17283,18450,18465,18483,18729,18834,18970,19105,19387,21080,21125,21800,21890,21930,22565,22610,23130,23205,24936,24966,26136,26241,26265,26646,26721,26985,27030,30584,30599,30839,33060,33090,33126,33300,33345,33365,33588,33603,33810,33825,33843,34085,34130,34326,34401,34679,37449,37524,37929,38034,38505,38550,39204,39234,39270,41290,41380,42010,42145,42330,42405,43540,43585,43605,46267,47947,48052,49452,49602,49692,49857,49980,50115,52242,52257,52275,53981,56621,56786,57838,60958,61153,65535}};


int main(){
    freopen("D-small-attempt0.in","r",stdin);
    freopen("D-small0.txt","w",stdout);
    int T,Case=1;
    int n,mask;
    int ans;
    for(scanf("%d",&T);Case<=T;Case++){
        scanf("%d",&n);
        mask=0;
        ans=0x7ffffff;
        for(int i=0;i<n*n;i++){
            int t;
            scanf("%1d",&t);
            mask=mask*2+t;
        }
        //printf("%d\n",mask);
        for(int i=0;table[n][i]>0;++i){
            //printf("%d\n",table[n][i]);
            if((mask|table[n][i]) == table[n][i]){
                bitset<25>a(mask),b(table[n][i]);
                ans=min(ans,(int)(b.count()-a.count()));
            }
        }
        printf("Case #%d: %d\n",Case,ans);
    }
    return 0;
}

