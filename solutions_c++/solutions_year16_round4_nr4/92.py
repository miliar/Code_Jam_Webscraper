#include <cstdio>
#include <cstring>

const int NN = 1;

const int N1 = 1;
const int N2 = 3;
const int N3 = 16;
const int N4 = 131;

int Ns[5] = {0, 1, 3, 16, 131};

char valids[5][140][5][5] = {
  {},
  { // 1 valid cases
    {"1"}
  },

  { // 3 valid cases
    {"01", "10"},
    {"10", "01"},
    {"11", "11"}
  },

  { // 16 valid cases
    {"001", "010", "100"},
    {"010", "001", "100"},
    {"011", "011", "100"},
    {"001", "100", "010"},
    {"100", "001", "010"},
    {"101", "101", "010"},
    {"001", "110", "110"},
    {"110", "001", "110"},
    {"010", "100", "001"},
    {"100", "010", "001"},
    {"110", "110", "001"},
    {"101", "010", "101"},
    {"010", "101", "101"},
    {"011", "100", "011"},
    {"100", "011", "011"},
    {"111", "111", "111"}
  },
  { // 131 valid cases
    {"0001", "0010", "0100", "1000"},
    {"0010", "0001", "0100", "1000"},
    {"0011", "0011", "0100", "1000"},
    {"0001", "0100", "0010", "1000"},
    {"0100", "0001", "0010", "1000"},
    {"0101", "0101", "0010", "1000"},
    {"0001", "0110", "0110", "1000"},
    {"0110", "0001", "0110", "1000"},
    {"0010", "0100", "0001", "1000"},
    {"0100", "0010", "0001", "1000"},
    {"0110", "0110", "0001", "1000"},
    {"0101", "0010", "0101", "1000"},
    {"0010", "0101", "0101", "1000"},
    {"0011", "0100", "0011", "1000"},
    {"0100", "0011", "0011", "1000"},
    {"0111", "0111", "0111", "1000"},
    {"0001", "0010", "1000", "0100"},
    {"0010", "0001", "1000", "0100"},
    {"0011", "0011", "1000", "0100"},
    {"0001", "1000", "0010", "0100"},
    {"1000", "0001", "0010", "0100"},
    {"1001", "1001", "0010", "0100"},
    {"0001", "1010", "1010", "0100"},
    {"1010", "0001", "1010", "0100"},
    {"0010", "1000", "0001", "0100"},
    {"1000", "0010", "0001", "0100"},
    {"1010", "1010", "0001", "0100"},
    {"1001", "0010", "1001", "0100"},
    {"0010", "1001", "1001", "0100"},
    {"0011", "1000", "0011", "0100"},
    {"1000", "0011", "0011", "0100"},
    {"1011", "1011", "1011", "0100"},
    {"0001", "0010", "1100", "1100"},
    {"0010", "0001", "1100", "1100"},
    {"0011", "0011", "1100", "1100"},
    {"0001", "1100", "0010", "1100"},
    {"1100", "0001", "0010", "1100"},
    {"0010", "1100", "0001", "1100"},
    {"1100", "0010", "0001", "1100"},
    {"0011", "1100", "0011", "1100"},
    {"1100", "0011", "0011", "1100"},
    {"0001", "0100", "1000", "0010"},
    {"0100", "0001", "1000", "0010"},
    {"0101", "0101", "1000", "0010"},
    {"0001", "1000", "0100", "0010"},
    {"1000", "0001", "0100", "0010"},
    {"1001", "1001", "0100", "0010"},
    {"0001", "1100", "1100", "0010"},
    {"1100", "0001", "1100", "0010"},
    {"0100", "1000", "0001", "0010"},
    {"1000", "0100", "0001", "0010"},
    {"1100", "1100", "0001", "0010"},
    {"1001", "0100", "1001", "0010"},
    {"0100", "1001", "1001", "0010"},
    {"0101", "1000", "0101", "0010"},
    {"1000", "0101", "0101", "0010"},
    {"1101", "1101", "1101", "0010"},
    {"0001", "1010", "0100", "1010"},
    {"1010", "0001", "0100", "1010"},
    {"0001", "0100", "1010", "1010"},
    {"0100", "0001", "1010", "1010"},
    {"0101", "0101", "1010", "1010"},
    {"1010", "0100", "0001", "1010"},
    {"0100", "1010", "0001", "1010"},
    {"0101", "1010", "0101", "1010"},
    {"1010", "0101", "0101", "1010"},
    {"0001", "0110", "1000", "0110"},
    {"0110", "0001", "1000", "0110"},
    {"0001", "1000", "0110", "0110"},
    {"1000", "0001", "0110", "0110"},
    {"1001", "1001", "0110", "0110"},
    {"0110", "1000", "0001", "0110"},
    {"1000", "0110", "0001", "0110"},
    {"1001", "0110", "1001", "0110"},
    {"0110", "1001", "1001", "0110"},
    {"0001", "1110", "1110", "1110"},
    {"1110", "0001", "1110", "1110"},
    {"1110", "1110", "0001", "1110"},
    {"0010", "0100", "1000", "0001"},
    {"0100", "0010", "1000", "0001"},
    {"0110", "0110", "1000", "0001"},
    {"0010", "1000", "0100", "0001"},
    {"1000", "0010", "0100", "0001"},
    {"1010", "1010", "0100", "0001"},
    {"0010", "1100", "1100", "0001"},
    {"1100", "0010", "1100", "0001"},
    {"0100", "1000", "0010", "0001"},
    {"1000", "0100", "0010", "0001"},
    {"1100", "1100", "0010", "0001"},
    {"1010", "0100", "1010", "0001"},
    {"0100", "1010", "1010", "0001"},
    {"0110", "1000", "0110", "0001"},
    {"1000", "0110", "0110", "0001"},
    {"1110", "1110", "1110", "0001"},
    {"1001", "0010", "0100", "1001"},
    {"0010", "1001", "0100", "1001"},
    {"1001", "0100", "0010", "1001"},
    {"0100", "1001", "0010", "1001"},
    {"1001", "0110", "0110", "1001"},
    {"0110", "1001", "0110", "1001"},
    {"0010", "0100", "1001", "1001"},
    {"0100", "0010", "1001", "1001"},
    {"0110", "0110", "1001", "1001"},
    {"0101", "0010", "1000", "0101"},
    {"0010", "0101", "1000", "0101"},
    {"0101", "1000", "0010", "0101"},
    {"1000", "0101", "0010", "0101"},
    {"0101", "1010", "1010", "0101"},
    {"1010", "0101", "1010", "0101"},
    {"0010", "1000", "0101", "0101"},
    {"1000", "0010", "0101", "0101"},
    {"1010", "1010", "0101", "0101"},
    {"1101", "1101", "0010", "1101"},
    {"1101", "0010", "1101", "1101"},
    {"0010", "1101", "1101", "1101"},
    {"0011", "0100", "1000", "0011"},
    {"0100", "0011", "1000", "0011"},
    {"0011", "1000", "0100", "0011"},
    {"1000", "0011", "0100", "0011"},
    {"0011", "1100", "1100", "0011"},
    {"1100", "0011", "1100", "0011"},
    {"0100", "1000", "0011", "0011"},
    {"1000", "0100", "0011", "0011"},
    {"1100", "1100", "0011", "0011"},
    {"1011", "1011", "0100", "1011"},
    {"1011", "0100", "1011", "1011"},
    {"0100", "1011", "1011", "1011"},
    {"0111", "0111", "1000", "0111"},
    {"0111", "1000", "0111", "0111"},
    {"1000", "0111", "0111", "0111"},
    {"1111", "1111", "1111", "1111"}
  }
};

char p[5][5];

// int ty[5];

int main(){
  /*
     for(int n = 0; n < (1 << (NN * NN)); n++){
     int n_ = n;
     for(int i = 0; i < NN; i++){
     for(int j = 0; j < NN; j++){
     p[i][j] = '0' + n_ % 2;
     n_ /= 2;
     }
     }

     bool val = true;

     for(int i = 0; i < NN; i++) ty[i] = 0;

     int tc = 0;
     for(int i = 0; i < NN; i++){
     if(ty[i] != 0) continue;
     tc++;
     ty[i] = tc;

     int cc = 1;

     for(int j = i + 1; j < NN; j++){
     if(strcmp(p[i], p[j]) == 0){ ty[j] = tc; cc++; }
     }

     int ccc = 0;
     for(int j = 0; j < NN; j++) if(p[i][j] == '1') ccc++;

     if(cc != ccc) val = false;
     }

     for(int i = 0; i < NN; i++){
     for(int j = i + 1; j < NN; j++){
     if(ty[i] != ty[j]){
     bool cr = false;
     for(int k = 0; k < NN; k++) if(p[i][k] == '1' && p[j][k] == '1') cr = true;
     if(cr) val = false;
     }
     }
     }

     for(int i = 0; i < NN; i++){
     bool cv = false;
     for(int j = 0; j < NN; j++){
     if(p[j][i] == '1') cv = true;
     }
     if(!cv) val = false;
     }

     if(val){
     printf("{\"%s\"", p[0]);
     for(int i = 1; i < NN; i++) printf(", \"%s\"", p[i]);
     printf("},\n");
     }
     }
   */

  int T; scanf("%d", &T);
  for(int tt = 1; tt <= T; tt++){
    int N; scanf("%d", &N);
    for(int i = 0; i < N; i++) scanf("%s", p[i]);

    int ans = 2147483647;

    for(int n = 0; n < Ns[N]; n++){
      int c = 0; bool val = true;
      for(int i = 0; i < N; i++){
        for(int j = 0; j < N; j++){
          if(valids[N][n][i][j] == '0' && p[i][j] == '1') val = false;
          if(valids[N][n][i][j] == '1' && p[i][j] == '0') c++;
        }
      }

      if(val && c < ans) ans = c;
    }

    printf("Case #%d: %d\n", tt, ans);
  }
  return 0;
}
