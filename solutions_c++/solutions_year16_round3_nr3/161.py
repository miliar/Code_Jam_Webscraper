#include <bits/stdc++.h>

using namespace std;

typedef long long LL;
int n;
int a[5][5][5][11];
string s[5][5][5][11];

void init(){
a[1][1][1][1]=1;
s[1][1][1][1]="111";
a[1][1][1][2]=1;
s[1][1][1][2]="111";
a[1][1][1][3]=1;
s[1][1][1][3]="111";
a[1][1][1][4]=1;
s[1][1][1][4]="111";
a[1][1][1][5]=1;
s[1][1][1][5]="111";
a[1][1][1][6]=1;
s[1][1][1][6]="111";
a[1][1][1][7]=1;
s[1][1][1][7]="111";
a[1][1][1][8]=1;
s[1][1][1][8]="111";
a[1][1][1][9]=1;
s[1][1][1][9]="111";
a[1][1][1][10]=1;
s[1][1][1][10]="111";
a[1][1][2][1]=1;
s[1][1][2][1]="111";
a[1][1][2][2]=2;
s[1][1][2][2]="111112";
a[1][1][2][3]=2;
s[1][1][2][3]="111112";
a[1][1][2][4]=2;
s[1][1][2][4]="112111";
a[1][1][2][5]=2;
s[1][1][2][5]="111112";
a[1][1][2][6]=2;
s[1][1][2][6]="111112";
a[1][1][2][7]=2;
s[1][1][2][7]="112111";
a[1][1][2][8]=2;
s[1][1][2][8]="111112";
a[1][1][2][9]=2;
s[1][1][2][9]="112111";
a[1][1][2][10]=2;
s[1][1][2][10]="112111";
a[1][1][3][1]=1;
s[1][1][3][1]="111";
a[1][1][3][2]=2;
s[1][1][3][2]="113112";
a[1][1][3][3]=3;
s[1][1][3][3]="113111112";
a[1][1][3][4]=3;
s[1][1][3][4]="112111113";
a[1][1][3][5]=3;
s[1][1][3][5]="111113112";
a[1][1][3][6]=3;
s[1][1][3][6]="112111113";
a[1][1][3][7]=3;
s[1][1][3][7]="112113111";
a[1][1][3][8]=3;
s[1][1][3][8]="111112113";
a[1][1][3][9]=3;
s[1][1][3][9]="112113111";
a[1][1][3][10]=3;
s[1][1][3][10]="113112111";
a[1][2][2][1]=2;
s[1][2][2][1]="111122";
a[1][2][2][2]=4;
s[1][2][2][2]="112122111121";
a[1][2][2][3]=4;
s[1][2][2][3]="122111112121";
a[1][2][2][4]=4;
s[1][2][2][4]="112121122111";
a[1][2][2][5]=4;
s[1][2][2][5]="111122112121";
a[1][2][2][6]=4;
s[1][2][2][6]="112111122121";
a[1][2][2][7]=4;
s[1][2][2][7]="122121111112";
a[1][2][2][8]=4;
s[1][2][2][8]="122121111112";
a[1][2][2][9]=4;
s[1][2][2][9]="111122112121";
a[1][2][2][10]=4;
s[1][2][2][10]="112122111121";
a[1][2][3][1]=2;
s[1][2][3][1]="121112";
a[1][2][3][2]=4;
s[1][2][3][2]="122112121111";
a[1][2][3][3]=6;
s[1][2][3][3]="123111112122113121";
a[1][2][3][4]=6;
s[1][2][3][4]="113112111123121122";
a[1][2][3][5]=6;
s[1][2][3][5]="112121111113122123";
a[1][2][3][6]=6;
s[1][2][3][6]="112111122121113123";
a[1][2][3][7]=6;
s[1][2][3][7]="122112113111123121";
a[1][2][3][8]=6;
s[1][2][3][8]="122121113112123111";
a[1][2][3][9]=6;
s[1][2][3][9]="111113122123112121";
a[1][2][3][10]=6;
s[1][2][3][10]="112123121113111122";
a[1][3][3][1]=3;
s[1][3][3][1]="122111133";
a[1][3][3][2]=6;
s[1][3][3][2]="133132113111122121";
a[1][3][3][3]=9;
s[1][3][3][3]="123121131122133111132113112";
a[1][3][3][4]=9;
s[1][3][3][4]="113123131111121122132112133";
a[1][3][3][5]=9;
s[1][3][3][5]="112121133122123113131132111";
a[1][3][3][6]=9;
s[1][3][3][6]="113121123133112122111132131";
a[1][3][3][7]=9;
s[1][3][3][7]="112131121122111133113132123";
a[1][3][3][8]=9;
s[1][3][3][8]="112133131111132113122123121";
a[1][3][3][9]=9;
s[1][3][3][9]="111121132112122113133131123";
a[1][3][3][10]=9;
s[1][3][3][10]="133111132112113123131121122";
a[2][2][2][1]=4;
s[2][2][2][1]="121112222211";
a[2][2][2][2]=8;
s[2][2][2][2]="222211221122121212111112";
a[2][2][2][3]=8;
s[2][2][2][3]="221111212211222112122121";
a[2][2][2][4]=8;
s[2][2][2][4]="222221211212112111121122";
a[2][2][2][5]=8;
s[2][2][2][5]="121212112111221211222122";
a[2][2][2][6]=8;
s[2][2][2][6]="211121212112122111221222";
a[2][2][2][7]=8;
s[2][2][2][7]="112121222122221111212211";
a[2][2][2][8]=8;
s[2][2][2][8]="121112211111212221122222";
a[2][2][2][9]=8;
s[2][2][2][9]="211122121222212221111112";
a[2][2][2][10]=8;
s[2][2][2][10]="211111122212221112121222";
a[2][2][3][1]=4;
s[2][2][3][1]="221111123212";
a[2][2][3][2]=8;
s[2][2][3][2]="113123211213122222111221";
a[2][2][3][3]=12;
s[2][2][3][3]="211223222213122113111112123212221121";
a[2][2][3][4]=12;
s[2][2][3][4]="211121111212123223112213113122221222";
a[2][2][3][5]=12;
s[2][2][3][5]="123111222221122223211112213121212113";
a[2][2][3][6]=12;
s[2][2][3][6]="112222111211221121113123223213212122";
a[2][2][3][7]=12;
s[2][2][3][7]="221112123223111212121211213222122113";
a[2][2][3][8]=12;
s[2][2][3][8]="211112122123223113121213221222212111";
a[2][2][3][9]=12;
s[2][2][3][9]="123212222223122112213111221113211121";
a[2][2][3][10]=12;
s[2][2][3][10]="121112111211123221213212113122223222";
a[2][3][3][1]=6;
s[2][3][3][1]="231111222123132213";
a[2][3][3][2]=12;
s[2][3][3][2]="111121132123231223233112133222211212";
a[2][3][3][3]=18;
s[2][3][3][3]="213231121232131122223233111221132112212123113222133211";
a[2][3][3][4]=18;
s[2][3][3][4]="121221113123223233112232222212111131133132231122211213";
a[2][3][3][5]=18;
s[2][3][3][5]="221121232233113111131112132223211231222133122213212123";
a[2][3][3][6]=18;
s[2][3][3][6]="223232112113222111133121132123211131221212122231233213";
a[2][3][3][7]=18;
s[2][3][3][7]="212131213233113122123211232223231221111133132112121222";
a[2][3][3][8]=18;
s[2][3][3][8]="233221123211113131133112111213122232212121223222231132";
a[2][3][3][9]=18;
s[2][3][3][9]="233133232231122212211221131113112222132111121213223123";
a[2][3][3][10]=18;
s[2][3][3][10]="231223122232112113131233213123111121222211212133221132";
a[3][3][3][1]=9;
s[3][3][3][1]="332311112231323121213222133";
a[3][3][3][2]=18;
s[3][3][3][2]="121312113233213331131222123311132333232323221211112322";
a[3][3][3][3]=27;
s[3][3][3][3]="221332211233312231131232311113222322121331321213212123112122133223111313132333323";
a[3][3][3][4]=27;
s[3][3][3][4]="233223312323123131232121321222332313213113212221111231122322211333311133331112132";
a[3][3][3][5]=27;
s[3][3][3][5]="332122212331232121211231213131221321112223111132311312113323222333313123133322233";
a[3][3][3][6]=27;
s[3][3][3][6]="233322231211311131112212333132113121321133312122332323213313123221331223111232222";
a[3][3][3][7]=27;
s[3][3][3][7]="132332213223121321232322212331311323222221313231133123233312111211113333122131112";
a[3][3][3][8]=27;
s[3][3][3][8]="312322111132213321223311212113122123231222313323131233112332232211331221333133121";
a[3][3][3][9]=27;
s[3][3][3][9]="213222331133211321313212312113122232231322111121123132233333332131323223311221112";
a[3][3][3][10]=27;
s[3][3][3][10]="122211333111322232121113321131233112332323222133221312331213313231132123223212311";

}

int main(){
	init();
	int T;
	scanf("%d",&T);
	for (int ti=1;ti<=T;ti++){
		int x,y,z,k;
		scanf("%d%d%d%d",&x,&y,&z,&k);
		printf("Case #%d: %d\n",ti,a[x][y][z][k]);
		string ss=s[x][y][z][k];
		for (int i=0;i<ss.length()/3;i++){
			printf("%c %c %c\n",ss[i*3],ss[i*3+1],ss[i*3+2]);
		}
	}
	return 0;
}