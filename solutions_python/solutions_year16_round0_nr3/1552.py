{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "collapsed": false,
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Case #1:\n",
      "10000000000000000000000000000001 3 2 2147418113 2 7 2 3 2 11\n",
      "10000000000000000000000000000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000000001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000000010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000000011001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000000000011111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000000100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000000101111 5 2 3 2 11 2 5 2 3\n",
      "10000000000000000000000000110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000000110111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000000111101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000001001001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000001001111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001011011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000001100111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001101101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001110011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001111001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000001111111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000010000101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000010010001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000010010111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000010011101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000010110101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000011000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000011100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000011110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000011111101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000100000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000100001001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000100001111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000100011011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000100100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000100100111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000100101101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000100110011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000100111001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000100111111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000101000111 5 2 3 2 13 2 5 2 3\n",
      "10000000000000000000000101001011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000101100011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000101101001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000101101111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000101111011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000110000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000110000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000110001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000110010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000110011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000110011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000110100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000110110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000110110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000110111101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000111000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000111001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000111001111 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000000111011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000111100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000000111100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000111101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000111101111 7 13 3 19 19 3 17 7 3\n",
      "10000000000000000000000111110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000111111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000000111111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000001000000101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001000010001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000001000010111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001000011101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001000110101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001001000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001001011 5 2 3 2 13 2 5 2 3\n",
      "10000000000000000000001001001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001010011 46031 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001010101 5 2 3 2 19 2 5 2 3\n",
      "10000000000000000000001001011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001001100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001001110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001001111101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000001010000111 5 2 3 2 19 2 5 2 3\n",
      "10000000000000000000001010010101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001011000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001011010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001011010111 45813 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001011011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001011110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001100000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001100000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001100001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001100010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001100011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001100011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001100100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001100110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001100110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001100111101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001101000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001101001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001101001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001101011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001101100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001101100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001101101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001101110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001101111001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000001101111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000001110000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001110010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001110010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001110011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001110110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001111000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000001111000111 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000001111001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001111010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001111011001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001111011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000001111100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001111101111 5 2 17 2 5 2 5 2 13\n",
      "10000000000000000000001111110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000001111110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000001111111101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000010000000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010000001001 46281 2 5 2 7 2 3 2 7\n",
      "10000000000000000000010000001111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010000010111 5 2 3 2 19 2 5 2 3\n",
      "10000000000000000000010000011011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010000100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010000100111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010000101101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010000110011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010000111001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010000111111 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000010001001011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010001010011 5 2 3 2 13 2 5 2 3\n",
      "10000000000000000000010001100011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010001101001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010001101111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010001111011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010010000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010010000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010010001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010010010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010010011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010010011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010010100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010010110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010010110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010010111101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000010011000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010011001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010011001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010011011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010011100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010011100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010011101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010011110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010011111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010011111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000010100001011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010100100011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010100101001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010100101111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010100111011 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000010101101011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010101111101 3 7 3 3 17 3 3 7 3\n",
      "10000000000000000000010110000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010110001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010110001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010110011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010110100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000010110100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010110101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010110110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010110111001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000010110111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000010111001011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010111100011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010111101001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000010111101111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000010111110111 5 2 7 2 5 2 5 2 7\n",
      "10000000000000000000010111111011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011000000001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011000000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011000001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011000010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011000010101 5 2 3 2 11 2 5 2 3\n",
      "10000000000000000000011000011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011000011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011000100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011000110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011000110111 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011000111101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011001000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011001001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011001001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011001011011 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011001100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011001100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011001101101 45909 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011001110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011001111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011001111111 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000011010000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011010010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011010010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011010011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011010100001 5 2 3 2 13 2 5 2 3\n",
      "10000000000000000000011010110101 46287 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011011000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011011000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011011001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011011010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011011011001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011011011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011011100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011011110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011011110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011011111101 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000011100000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011100001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011100001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011100011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011100100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011100100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011100101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011100110011 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011100111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011100111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011101001011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011101100011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011101101001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011101101111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011101111011 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000011101111101 5 2 17 2 5 2 5 2 19\n",
      "10000000000000000000011110000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000011110000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011110001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011110010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011110011001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011110011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011110100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011110101111 5 2 17 2 5 2 5 2 7\n",
      "10000000000000000000011110110001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000011110110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011110111101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011111000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011111001001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011111001111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011111011011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011111100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000011111100111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011111101101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011111110011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000011111111001 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000011111111111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100000000101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100000010001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100000010111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100000011101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100000110101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100001000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100001100011 5 2 3 2 13 2 5 2 3\n",
      "10000000000000000000100001100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100001110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100001111101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100010010101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100010110001 13 2 3 2 17 2 11 2 3\n",
      "10000000000000000000100011000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100011010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100011010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100011011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100011110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100100000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100100000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100100001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100100010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100100011001 46293 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100100011111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100100100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100100110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100100110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100100111101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000100101000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100101001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100101001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100101011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100101100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100101100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100101101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100101110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100101111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100101111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000100110000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100110001001 7 2 3 2 17 2 5 2 3\n",
      "10000000000000000000100110010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100110010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100110011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100110110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000100111000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111011001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000100111100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111101011 3 5 3 3 19 3 3 7 3\n",
      "10000000000000000000100111110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000100111110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000100111111101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000101000010101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000101000111111 3 7 3 3 17 3 3 7 3\n",
      "10000000000000000000101001000011 5 2 3 2 17 2 5 2 3\n",
      "10000000000000000000101001000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000101001010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000101001010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101001011101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000101001110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101011010101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101011100011 5 2 17 2 11 2 5 2 13\n",
      "10000000000000000000101100000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000101100010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000101100010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101100011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101100110101 46299 2 5 2 7 2 3 2 7\n",
      "10000000000000000000101100111011 3 7 3 3 13 3 3 7 3\n",
      "10000000000000000000101101000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000101101000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101101001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101101010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101101011001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000101101011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000101101100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101101110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101101110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000101101111101 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000101110010101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101111000101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101111010001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000101111010101 7 5 3 11 11 3 5 7 3\n",
      "10000000000000000000101111010111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000101111011101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000101111110101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110000000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110000000111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110000001101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110000010011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110000011001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110000011111 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000110000100101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110000110001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110000110111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110000111101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110001001001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110001001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001011011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110001100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001101101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110001111111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110010000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110010010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110010010111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110010011101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000110010110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110011000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011011001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110011100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110011110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110011111101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110100000011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110100001001 46305 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110100001111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110100011011 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000110100100001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110100100111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110100101101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000110100110011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110100111001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110100111111 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000110101001011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110101011101 3 7 3 3 13 3 3 7 3\n",
      "10000000000000000000110101100011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110101101001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110101101111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110101111011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110110000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000110110000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110110001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110110010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110110011001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000110110011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110110100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110110110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110110110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110110111101 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000110111000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110111001001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110111001111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110111011011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110111100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000110111100111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110111101001 7 13 3 19 19 3 11 7 3\n",
      "10000000000000000000110111101101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110111110011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110111111001 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000110111111111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111000000011 5 2 3 2 11 2 5 2 3\n",
      "10000000000000000000111000000101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111000010001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111000010111 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111000011101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111000110101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111001000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111001000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111001001101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111001010011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111001011001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111001011111 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111001100101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111001110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111001110111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111001111011 5 2 17 2 5 2 5 2 17\n",
      "10000000000000000000111001111101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111010010101 46311 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111010101101 3 7 3 3 11 3 3 7 3\n",
      "10000000000000000000111010110011 3 17 3 3 13 3 3 11 3\n",
      "10000000000000000000111011000101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111011010001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111011010111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111011011101 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111011110011 5 2 17 2 5 2 5 2 7\n",
      "10000000000000000000111011110101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111100000001 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111100000111 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111100001101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111100010011 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111100011001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111100011111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111100100101 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111100110001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111100110111 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111100111101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111101000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111101001001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111101001111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111101011011 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111101100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111101100111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111101101101 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111101110011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111101111001 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111101111111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111110000101 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111110001011 3 5 3 3 13 3 3 11 3\n",
      "10000000000000000000111110010001 3 2 5 2 7 2 3 2 7\n",
      "10000000000000000000111110010111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111110011101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111110110101 3 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111111000001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000000111111000111 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111111001101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111111010011 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111111011001 46317 2 5 2 5 2 3 2 7\n",
      "10000000000000000000111111011111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111111100101 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111111110001 3 2 5 2 5 2 3 2 11\n",
      "10000000000000000000111111110111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000000111111111101 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000001000000000011 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000001000000001001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000001000000001111 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000001000000011011 3 2 3 2 7 2 3 2 3\n",
      "10000000000000000001000000100001 3 2 5 2 7 2 3 2 11\n",
      "10000000000000000001000000100111 3 2 3 2 7 2 3 2 3\n"
     ]
    }
   ],
   "source": [
    "from itertools import product\n",
    "import numpy as np\n",
    "\n",
    "N = 32\n",
    "J = 500\n",
    "\n",
    "coins = {} # binary string -> dict\n",
    "count = 0\n",
    "def getDivisor(x):\n",
    "    if x%2 == 0:\n",
    "        return 2\n",
    "    \n",
    "    div = 3\n",
    "#     while div*div <= x:\n",
    "    while div <= 19:\n",
    "        if x % div == 0:\n",
    "            return div\n",
    "        div += 2\n",
    "    return -1\n",
    "\n",
    "# Reference: http://stackoverflow.com/questions/15390807/integer-square-root-in-python\n",
    "def isqrt(n):\n",
    "    x = n\n",
    "    y = (x + 1) // 2\n",
    "    while y < x:\n",
    "        x = y\n",
    "        y = (x + n // x) // 2\n",
    "    return x\n",
    "# ========\n",
    "\n",
    "def isSquare(x):\n",
    "    a = isqrt(x)\n",
    "    return a*a == x\n",
    "\n",
    "def fermFactor(N):\n",
    "    C = 5\n",
    "    a = isqrt(N)\n",
    "    b2 = a*a - N\n",
    "    count = 0\n",
    "    while not isSquare(b2) and count < C:\n",
    "        a += 1\n",
    "        b2 = a*a - N\n",
    "        count += 1\n",
    "    \n",
    "    if count == C:\n",
    "        return -1\n",
    "    else:\n",
    "        return a - isqrt(b2)\n",
    "    \n",
    "\n",
    "\n",
    "print 'Case #1:'\n",
    "for bits in product([0, 1], repeat = N-2):\n",
    "    curS = '1' + ''.join( str(b) for b in bits ) + '1'    \n",
    "    entry = {}\n",
    "    divs = []\n",
    "    for base in xrange(2, 11):\n",
    "        num = 0\n",
    "        for i in xrange(0, len(curS)):\n",
    "            if curS[N-i-1] == '1':\n",
    "                 num += base**i\n",
    "        entry[base] = num\n",
    "        \n",
    "        div = 2 if num%2 == 0 else fermFactor(num)       \n",
    "        \n",
    "        if div == -1:\n",
    "            div = getDivisor(num)\n",
    "        \n",
    "        if div == -1:            \n",
    "            break\n",
    "        else:\n",
    "            divs.append(str(div))\n",
    "            \n",
    "    if len(divs) == 9:\n",
    "        count += 1\n",
    "        print '%s %s'%(curS, ' '.join(divs))\n",
    "        \n",
    "    coins[curS] = entry    \n",
    "    \n",
    "    if count >= J:\n",
    "        break\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
